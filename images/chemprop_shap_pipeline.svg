<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 290" font-family="'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif">
  <defs>
    <linearGradient id="p-smiles" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#6A1B9A"/>
      <stop offset="100%" stop-color="#8E24AA"/>
    </linearGradient>
    <linearGradient id="p-rdkit" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#1565C0"/>
      <stop offset="100%" stop-color="#1E88E5"/>
    </linearGradient>
    <linearGradient id="p-features" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#00897B"/>
      <stop offset="100%" stop-color="#009688"/>
    </linearGradient>
    <linearGradient id="p-model" x1="0" y1="0" x2="1" y2="0">
      <stop offset="0%" stop-color="#1a6b8a"/>
      <stop offset="100%" stop-color="#2196a9"/>
    </linearGradient>
    <filter id="p-shadow">
      <feDropShadow dx="1" dy="2" stdDeviation="2" flood-opacity="0.15"/>
    </filter>
  </defs>

  <!-- Title -->
  <text x="500" y="36" text-anchor="middle" font-size="24" font-weight="700" fill="#E0E0E0">ChemProp SHAP Ablation Pipeline</text>

  <!-- Box 1: SMILES -->
  <rect x="20" y="60" width="170" height="80" rx="10" fill="url(#p-smiles)" filter="url(#p-shadow)"/>
  <text x="105" y="97" text-anchor="middle" font-size="22" font-weight="700" fill="white">SMILES</text>
  <text x="105" y="122" text-anchor="middle" font-size="18" fill="#E1BEE7">Input strings</text>

  <!-- Arrow 1→2 -->
  <line x1="190" y1="100" x2="222" y2="100" stroke="#888" stroke-width="2.5"/>
  <polygon points="220,94 234,100 220,106" fill="#888"/>

  <!-- Box 2: RDKit Graph -->
  <rect x="234" y="60" width="210" height="80" rx="10" fill="url(#p-rdkit)" filter="url(#p-shadow)"/>
  <text x="339" y="93" text-anchor="middle" font-size="22" font-weight="700" fill="white">RDKit Graph</text>
  <text x="339" y="122" text-anchor="middle" font-size="18" fill="#BBDEFB">Valid molecular graph</text>

  <!-- Arrow 2→3 -->
  <line x1="444" y1="100" x2="476" y2="100" stroke="#888" stroke-width="2.5"/>
  <polygon points="474,94 488,100 474,106" fill="#888"/>

  <!-- Box 3: Feature Vectors (highlighted) -->
  <rect x="488" y="55" width="240" height="90" rx="10" fill="url(#p-features)" filter="url(#p-shadow)" stroke="#FF9800" stroke-width="2.5"/>
  <text x="608" y="93" text-anchor="middle" font-size="22" font-weight="700" fill="white">Feature Vectors</text>
  <text x="608" y="122" text-anchor="middle" font-size="18" fill="#B2DFDB">72-bit atom + 14-bit bond</text>

  <!-- Arrow 3→4 -->
  <line x1="728" y1="100" x2="760" y2="100" stroke="#888" stroke-width="2.5"/>
  <polygon points="758,94 772,100 758,106" fill="#888"/>

  <!-- Box 4: Model Inference -->
  <rect x="772" y="60" width="200" height="80" rx="10" fill="url(#p-model)" filter="url(#p-shadow)"/>
  <text x="872" y="93" text-anchor="middle" font-size="22" font-weight="700" fill="white">MPNN Model</text>
  <text x="872" y="122" text-anchor="middle" font-size="18" fill="#B2EBF2">Prediction</text>

  <!-- Ablation annotation arrow pointing up to Feature Vectors box -->
  <line x1="608" y1="205" x2="608" y2="153" stroke="#FF9800" stroke-width="2.5"/>
  <polygon points="601,155 608,143 615,155" fill="#FF9800"/>

  <!-- Ablation label -->
  <rect x="468" y="208" width="280" height="68" rx="8" fill="none" stroke="#FF9800" stroke-width="1.5" stroke-dasharray="6,3"/>
  <text x="608" y="234" text-anchor="middle" font-size="20" font-weight="700" fill="#FF9800">Bit ablation here</text>
  <text x="608" y="260" text-anchor="middle" font-size="18" fill="#BDBDBD">Downstream of chemical validity</text>
</svg>
